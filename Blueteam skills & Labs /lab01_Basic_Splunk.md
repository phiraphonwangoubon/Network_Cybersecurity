# Basic Splunk

***

1 ) ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Splunk App / Splunk Add-on (TA) ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Splunk Enterprise (Splunk Search)

<img width="932" height="391" alt="image" src="https://github.com/user-attachments/assets/e6fb7de7-7621-4174-a945-68e6c373b3c4" />

1.1 ) ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ upload

<img width="1058" height="521" alt="image" src="https://github.com/user-attachments/assets/4e5a5cba-9048-4a24-a4e7-72bfd453271c" />

    üëâ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£

    ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Splunk Add-on ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô

    - Cisco

    - pfSense

    ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏•‡πà‡∏≤‡∏á‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå
    üëâ ta-pfsense_210.tgz ‡∏ã‡∏∂‡πà‡∏á‡∏Ñ‡∏∑‡∏≠ Splunk Add-on for pfSense (TA-pfSense)

    Add-on (TA) ‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:

    - ‡πÅ‡∏õ‡∏•‡∏á log ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô format ‡∏ó‡∏µ‡πà Splunk ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à

    - ‡∏ó‡∏≥ field extraction (src_ip, dest_ip, action ‡∏Ø‡∏•‡∏Ø)

    - ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ / ‡∏ó‡∏≥ Dashboard ‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ

***

2 ) ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Add data / log ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏°‡∏≤‡πÑ‡∏î‡πâ

<img width="1919" height="965" alt="image" src="https://github.com/user-attachments/assets/bf16f3ad-5d4c-42d1-a4d7-7c9acbb64f58" />

<img width="900" height="484" alt="image" src="https://github.com/user-attachments/assets/406db8da-f489-441a-8da7-6d0026086577" />

<img width="879" height="520" alt="image" src="https://github.com/user-attachments/assets/dcc179be-aa33-4ed0-9ac3-9da1b3131431" />

<img width="1096" height="389" alt="image" src="https://github.com/user-attachments/assets/52cdffdd-08c9-45de-8d90-c372a1144108" />

***

3 ) ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô Splunk

<img width="1384" height="662" alt="image" src="https://github.com/user-attachments/assets/1b58d65b-3c48-437d-89b9-dff0c6c2d837" />

<img width="486" height="762" alt="image" src="https://github.com/user-attachments/assets/c5a6f6c2-b574-4e41-bfd5-962c18275b26" />

4 ) ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Test Search & Specifying time range
 
 <img width="1919" height="969" alt="image" src="https://github.com/user-attachments/assets/613e1da1-232c-49f0-b9ce-da622aaaa90f" />

 <img width="1919" height="967" alt="image" src="https://github.com/user-attachments/assets/ee46718b-1a20-4092-917f-b6b2a6f4fcbd" />

5 ) ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ fields 

<img width="1257" height="676" alt="image" src="https://github.com/user-attachments/assets/02464622-0a14-4fd5-9c1a-0aa899ded74c" />

<img width="1253" height="435" alt="image" src="https://github.com/user-attachments/assets/c731780b-dd18-4712-b236-cde4f6c63d82" />

<img width="1043" height="482" alt="image" src="https://github.com/user-attachments/assets/119bf878-b1fe-49ed-8dae-fae044f03bda" />

5.1 ) ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏≠‡∏á Splunk ‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π 

‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á: index="lab0" sourcetype="cisco:asa" tcp | top severity_level

<img width="1959" height="327" alt="image" src="https://github.com/user-attachments/assets/70650c7b-44cc-46a8-8a7c-5a42010b341b" />

5.2 ) 

<img width="1917" height="963" alt="image" src="https://github.com/user-attachments/assets/803fca96-6737-496a-b1db-f6210833a58b" />


1Ô∏è‚É£ ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (Search part)

    index="lab0" sourcetype="cisco:asa" transport=tcp severity_level=informational


‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢:

index="lab0" ‚Üí ‡∏Ñ‡πâ‡∏ô log ‡∏à‡∏≤‡∏Å index ‡∏ä‡∏∑‡πà‡∏≠ lab0

sourcetype="cisco:asa" ‚Üí log ‡∏à‡∏≤‡∏Å Cisco ASA firewall

transport=tcp ‚Üí ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ traffic ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô TCP

severity_level=informational ‚Üí log ‡∏£‡∏∞‡∏î‡∏±‡∏ö informational

2Ô∏è‚É£ ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Transforming command)

    | stats count by dest_ip


‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢

‡πÅ‡∏õ‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏Ñ‡∏ô:

‚Äú‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô log ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° IP ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (dest_ip)‚Äù

Splunk ‡∏à‡∏∞‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏µ‡πâ:

‡πÄ‡∏≠‡∏≤ event ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡πÄ‡∏à‡∏≠

‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° (group) ‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤ dest_ip

‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô event ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ IP

‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤:

‡∏°‡∏µ log TCP informational

‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πà‡∏á‡πÑ‡∏õ‡∏´‡∏≤ 10.122.68.227 ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 25 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á

‡∏î‡∏π‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤ IP ‡πÑ‡∏´‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

5.3 ) HEAD 

        command : index="lab0" sourcetype=cisco:asa | head 5

<img width="1925" height="722" alt="image" src="https://github.com/user-attachments/assets/94ac5b52-0ea9-443f-85ab-3a1961a072eb" />

--- ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ---

1Ô∏è‚É£ | head 5

üëâ ‡πÄ‡∏≠‡∏≤ 5 event ‡πÅ‡∏£‡∏Å‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á

2Ô∏è‚É£ | tail 5

üëâ ‡πÄ‡∏≠‡∏≤ 5 event ‡∏à‡∏≤‡∏Å‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á

5.4 ) TOP

        command : index="lab0" sourcetype=cisco:asa | top src_ip

<img width="1899" height="638" alt="image" src="https://github.com/user-attachments/assets/1a15610d-b368-4ff9-8ecf-28297cea79d8" />

<img width="1919" height="920" alt="image" src="https://github.com/user-attachments/assets/348984b0-7e4a-45a3-b8ce-da690caa4300" />

Splunk ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:

- ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏° src_ip

- ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô event ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ IP

- ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å ‚Üí ‡∏ô‡πâ‡∏≠‡∏¢

- ‡πÅ‡∏™‡∏î‡∏á Top 10 ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

üëâ ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏á

- ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏á‡∏≤‡∏ô security üîê

- ‡∏´‡∏≤ IP ‡∏ó‡∏µ‡πà‡∏¢‡∏¥‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

- ‡∏´‡∏≤ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å traffic ‡πÄ‡∏¢‡∏≠‡∏∞‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥

- ‡∏ï‡∏£‡∏ß‡∏à Brute force / Scan

- ‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏ó‡∏≥ Dashboard Top Talkers

5.5 ) rare

        command : index="lab0" sourcetype=cisco:asa | rare src_ip

<img width="1901" height="600" alt="image" src="https://github.com/user-attachments/assets/328e8962-7796-4eda-bcd9-0dbf91d5318c" />

üëâtop src_ip	IP ‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

üëârare src_ip	IP ‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ô‡πâ‡∏≠‡∏¢

5.6 ) table

        command: index="lab0" sourcetype=cisco:asa transport=* | table src_ip transport

<img width="1886" height="439" alt="image" src="https://github.com/user-attachments/assets/6c8abbbd-bac2-471f-8ef7-463532e48bc0" />

1Ô∏è‚É£ ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (Search)
index="lab0" sourcetype=cisco:asa transport=*


‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢:

index="lab0" ‚Üí ‡∏Ñ‡πâ‡∏ô‡∏à‡∏≤‡∏Å index lab0

sourcetype=cisco:asa ‚Üí log ‡∏à‡∏≤‡∏Å Cisco ASA

transport=* ‚Üí

üëâ ‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞ event ‡∏ó‡∏µ‡πà‡∏°‡∏µ field transport

* = ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á ‚Äú‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‚Äù

üìå ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏á event ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô TCP / UDP / ICMP ‡∏Ø‡∏•‡∏Ø

2Ô∏è‚É£ ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (Formatting)

| table src_ip transport

‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢:

‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô ‡∏ï‡∏≤‡∏£‡∏≤‡∏á

‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞ field:

src_ip ‚Üí IP ‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á

transport ‚Üí ‡πÇ‡∏õ‡∏£‡πÇ‡∏ï‡∏Ñ‡∏≠‡∏• (tcp / udp ‡∏Ø‡∏•‡∏Ø)

Field ‡∏≠‡∏∑‡πà‡∏ô ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á

5.7 )

        command : index="lab0" sourcetype="cisco:asa" | stats count by severity_level

<img width="959" height="730" alt="image" src="https://github.com/user-attachments/assets/2fcea09b-fb82-4c48-9883-a98edcc3ef1b" />

‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ ‚ÄúFirewall ‡∏™‡πà‡∏á log ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÑ‡∏´‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‚Äù

severity_level ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ (Cisco ASA)

    üìå ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏Ç‡∏≠‡∏á syslog (‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏•‡∏Ç‡∏ô‡πâ‡∏≠‡∏¢ = ‡∏¢‡∏¥‡πà‡∏á‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á):

        emergency (0) -	‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πà‡∏°

        alert (1)	  - ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡∏°‡∏≤‡∏Å

        critical (2)  - ‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á

        error (3)	  - ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î

        warning (4)	  - ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

        notice (5)	  - ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ

        informational (6)	- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ

        debug (7)     - ‡∏î‡∏µ‡∏ö‡∏±‡∏Å 
















